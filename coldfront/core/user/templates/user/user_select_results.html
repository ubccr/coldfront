
{% if matches %}
  {% if number_of_usernames_found %}
    <strong>Found {{number_of_usernames_found}} of {{number_of_usernames_searched}} usernames searched.</strong> 
  {% endif %}
  {% if usernames_not_found %}
    The missing username{{usernames_not_found|length|pluralize}} {{usernames_not_found|length|pluralize:"is, are"}}: {{ usernames_not_found|join:", " }}.
  {% endif %}
  <form action="{% url 'user-select-results' %}" method="post">
    {% csrf_token %}
    {{ formset.management_form }}
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th scope="col"><input type="checkbox" class="check" id="selectAll"></th>
            <th scope="col">#</th>
            <th scope="col">Username</th>
            <th scope="col">First Name</th>
            <th scope="col">Last Name</th>
            <th scope="col">Email</th>
            <!-- <th scope="col">Source</th> -->
          </tr>
        </thead>
        <tbody>
          {% for form in formset %}
            <tr>
              <td scope="col">{{ form.selected }}</td>
              <td scope="col">{{ forloop.counter }}</td>
              <td scope="col">{{ form.username.value }}</td>
              <td scope="col">{{ form.first_name.value }}</td>
              <td scope="col">{{ form.last_name.value }}</td>
              <td scope="col">{{ form.email.value }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <button id="search-button" type="submit" name="select_users" class="btn btn-success"><i class="fas fa-search" aria-hidden="true"></i> Select Users</button>
  </form>
  
{% else %}
  <div class="alert alert-info text-center">
    No results!
  </div>
{% endif %}

<script>
  $("#selectAll").click(function() {
    $("input[name^='userform-']").prop('checked', $(this).prop('checked'));
  });

  $("input[name^='userform-']").click(function(ele) {
    var id = $(this).attr('id');
    if (id != "selectAll") {
      $("#selectAll").prop('checked', false);
    }
  });
</script>
