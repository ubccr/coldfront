{% extends "common/base.html" %} {% load common_tags %} {% block content %}

<div class="row">
  <div class="col-lg-12">
    <h3>Welcome</h3>
    <hr>
    <p>If you would like to set up or update your access to a cluster, please complete the following steps.</p>
    <p>First Review and Sign the cluster user agreement. Only then you can Join a cluster project and gain access to the cluster.</p>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Task</th>
          <th scope="col">Status</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1. Sign the cluster user access agreement.</td>
          {% if user.userprofile.access_agreement_signed_date is not None %}
            <td>
              <span class="badge badge-success">
                <i class="fas fa-check"></i>
                Signed {{ user.userprofile.access_agreement_signed_date }}
              </span>
            </td>
            <td>
              <a href="{% url 'user-access-agreement' %}" class="btn btn-primary">
                Review
              </a>
            </td>
          {% else %}
            <td>
              <span class="badge badge-danger">
                <i class="fas fa-times"></i>
                Unsigned
              </span>
            </td>
            <td>
              <a href="{% url 'user-access-agreement' %}" class="btn btn-primary">
                <i class="fas fa-edit" aria-hidden="true"></i>
                Review and Sign
              </a>
            </td>
          {% endif %}
        </tr>
        <tr>
          <td>2. Create or join a project.</td>
          {% if user.userprofile.access_agreement_signed_date is not None %}
            <td>
              {% if project_list %}
                <span class="badge badge-success">
                  <i class="fas fa-check"></i>
                  {{ project_list|length }} Project(s)
                </span>
              {% else %}
                <span class="badge badge-danger">
                  <i class="fas fa-times"></i>
                  {{ project_list|length }} Project(s)
                </span>
              {% endif %}
            </td>
            <td>
              <a href="{% url 'project-request' %}" class="btn btn-primary">
                Create
              </a>
              <a href="{% url 'project-join-list' %}" class="btn btn-primary">
                Join
              </a>
            </td>
          {% else %}
            <td>
              <span class="badge badge-danger">
                <i class="fas fa-times"></i>
                {{ project_list|length }} Project(s)
              </span>
            </td>
            <td>
              <a href="{% url 'project-request' %}" class="btn btn-primary">
                Create
              </a>
              <button class="btn btn-primary" disabled="true">
                Join
              </button>
            </td>
          {% endif %}
        </tr>
      </tbody>
    </table>
  </div>


</div>
<br><br>

<div class="row">

  <div class="col-lg-12 mt-2">
    <a href="{% url 'project-list' %}">
      <h3>My BRC Cluster Projects &raquo;</h3>
    </a>
    <hr>
    {% if project_list %}
      <div class="row">
        <div class="col-lg-6 mt-2">
          <h4>Savio</h4>
          <hr>
          {% if savio_projects %}
            <ul class="list-group">
              {% for project in project_list %}
                {% if project.name in savio_projects %}
                  <li class="list-group-item">
                    <a href="{% url 'project-detail' project.pk %}">
                      <i class="fa fa-folder fa-lg" aria-hidden="true"></i>
                      {{ project.title }}
                    </a>
                    {% if project.needs_review %}
                      <a href="{% url 'project-review' project.pk %}">
                        <span class="badge badge-warning">Needs Review</span>
                      </a>
                    {% endif %}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <div class="alert alert-info" role="alert">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              You are not part of any Savio projects at this time. Please click Join to join any of the existing projects. You can also click Create to request setup of a new project.
            </div>
          {% endif %}
        </div>
        <div class="col-lg-6 mt-2">
          <h4>Vector</h4>
          <hr>
          {% if vector_projects %}
            <ul class="list-group">
              {% for project in project_list %}
                {% if project.name in vector_projects %}
                  <li class="list-group-item">
                    <a href="{% url 'project-detail' project.pk %}">
                      <i class="fa fa-folder fa-lg" aria-hidden="true"></i>
                      {{ project.title }}
                    </a>
                    {% if project.needs_review %}
                      <a href="{% url 'project-review' project.pk %}">
                        <span class="badge badge-warning">Needs Review</span>
                      </a>
                    {% endif %}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <div class="alert alert-info" role="alert">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              You are not part of any Vector projects at this time. Please click Join to join any of the existing projects. You can also click Create to request setup of a new project.
            </div>
          {% endif %}
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 mt-2"></div>
        <div class="col-lg-6 mt-2">
          <h4>ABC</h4>
          <hr>
          {% if abc_projects %}
            <ul class="list-group">
              {% for project in project_list %}
                {% if project.name in abc_projects %}
                  <li class="list-group-item">
                    <a href="{% url 'project-detail' project.pk %}">
                      <i class="fa fa-folder fa-lg" aria-hidden="true"></i>
                      {{ project.title }}
                    </a>
                    {% if project.needs_review %}
                      <a href="{% url 'project-review' project.pk %}">
                        <span class="badge badge-warning">Needs Review</span>
                      </a>
                    {% endif %}
                  </li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <div class="alert alert-info" role="alert">
              <i class="fa fa-info-circle" aria-hidden="true"></i>
              You are not part of any ABC projects at this time. Please click Join to join any of the existing projects.
            </div>
          {% endif %}
        </div>
      </div>
    {% else %}
      <div class="alert alert-info" role="alert">
        <i class="fa fa-info-circle" aria-hidden="true"></i>
        You are not part of any BRC cluster projects at this time. Please click Join to join any of the existing projects. You can also click Create to request setup of a new project.
      </div>
    {% endif %}
  </div>


<!-- We do not need to display allocations for the users in the home page -krishna.
  <div class="col-lg-6 mt-2">
    <a href="{% url 'allocation-list' %}">
      <h3>Allocations &raquo;</h3>
    </a>
    <hr>
    {% if allocation_list %}
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Project</th>
          <th scope="col">Resource</th>
          <th scope="col">Status</th>

        </tr>
      </thead>
      <tbody>
        {% for allocation in allocation_list %}
        <tr>
          <td>{{allocation.project.title}}</td>
          <td>{{allocation.get_parent_resource}}</td>
          {%  if allocation.status.name == "Expired" and allocation.expires_in < 0 %}
          <td><a href="{% url 'allocation-detail' allocation.id %}" class="btn btn-danger btn-block">Expired</a></td>
          {%  elif allocation.status.name == "Renewal Requested" %}
          <td><a href="{% url 'allocation-detail' allocation.id %}" class="btn btn-danger btn-block">Renewal
              Requested</a></td>
          {%  elif allocation.expires_in >= 0 and  allocation.expires_in <= 30 %}
          <td><a href="{% url 'allocation-detail' allocation.id %}" class="btn btn-danger btn-block">Expires in <span
                class="badge badge-light">{{allocation.expires_in}}</span> day{{allocation.expires_in|pluralize }}</a>
          </td>
          {% elif allocation.expires_in > 30 and allocation.expires_in <= 90 %}
          <td><a href="{% url 'allocation-detail' allocation.id %}" class="btn btn-warning btn-block">Expires in <span
                class="badge badge-light">{{allocation.expires_in}}</span> day{{allocation.expires_in|pluralize }}</a>
          </td>
          {% elif allocation.status.name == "Pending" %}
          <td><a href="{% url 'allocation-detail' allocation.id %}"
              class="btn btn-info btn-block">{{allocation.status}}</a></td>
          {% elif allocation.status.name == "Active" %}
          <td><a href="{% url 'allocation-detail' allocation.id %}"
              class="btn btn-success btn-block">{{allocation.status}}</a></td>
          {% else %}
          <td><a href="{% url 'allocation-detail' allocation.id %}"
              class="btn btn-info btn-block">{{allocation.status}}</a></td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>

    {% else %}
    <div class="alert alert-info" role="alert"><i class="fa fa-info-circle" aria-hidden="true"></i> There are no allocations to display.
    </div>
    {% endif %}
  </div>
-->

</div>
<div class="row">
  {% include "portal/extra_app_templates.html" %}
</div>
{% endblock %} {% block javascript %} {{ block.super }}
<script>
  $("#navbar-main > ul > li.active").removeClass("active");
  $("#navbar-home").addClass("active");
</script>
{% endblock %}
